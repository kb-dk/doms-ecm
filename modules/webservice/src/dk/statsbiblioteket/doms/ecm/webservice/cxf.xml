<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jaxrs="http://cxf.apache.org/jaxrs"
       xmlns:security="http://www.springframework.org/schema/security"
       xmlns:beans="http://www.springframework.org/schema/beans"

       xsi:schemaLocation=
               "http://www.springframework.org/schema/beans
                http://www.springframework.org/schema/beans/spring-beans.xsd
                http://cxf.apache.org/jaxrs
                http://cxf.apache.org/schemas/jaxrs.xsd
                http://www.springframework.org/schema/security
                http://www.springframework.org/schema/security/spring-security-2.0.4.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd"

       default-lazy-init="false"

        >

    <import resource="classpath:META-INF/cxf/cxf.xml"/>
    <import resource="classpath:META-INF/cxf/cxf-extension-jaxrs-binding.xml"/>
    <import resource="classpath:META-INF/cxf/cxf-servlet.xml"/>

    <jaxrs:server id="service" address="/">
        <jaxrs:serviceBeans>
            <ref bean="serviceImpl"/>
        </jaxrs:serviceBeans>
        <jaxrs:providers>
            <bean class="dk.statsbiblioteket.doms.ecm.webservice.EcmFaultBarrier"/>
<!--            <bean class="dk.statsbiblioteket.doms.ecm.webservice.FaultBarrier"/>-->
        </jaxrs:providers>
    </jaxrs:server>

    <bean id="serviceImpl"
          class="dk.statsbiblioteket.doms.ecm.webservice.Webservice"/>


    <security:http auto-config="false">
        <security:intercept-url pattern="/**" access="ROLE_ADMIN"/>
        <security:http-basic/>
        <security:logout/>

    </security:http>


    <bean id="authenticationManager" class="org.springframework.security.providers.ProviderManager">
        <property name="providers">
            <list>
                <ref local="customAuthenticationProvider" />
            </list>
        </property>
    </bean>


    <beans:bean id="customAuthenticationProvider"
                class="dk.statsbiblioteket.doms.ecm.webservice.Initializer">
        <security:custom-authentication-provider/>

        <!--<property name="userDetailsService" ref="customUserDetailsService"/>-->
    </beans:bean>



    <!--
        <beans:bean id="md5PasswordEncoder"
                    class="org.springframework.security.providers.encoding.Md5PasswordEncoder"/>

        <bean id="customUserDetailsService" scope="prototype"
                    class="net.sourceforge.fedora.ecm.userDetails">

        </bean>
    -->



</beans>